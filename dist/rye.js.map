{"version":3,"sources":["src/rye.js"],"names":[],"mappings":"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","file":"src/rye.js","sourcesContent":["class Region {\r\n  show(view) {\r\n    view.render();\r\n    var container = document.querySelector(this.container);\r\n\r\n    container.innerHTML = \"\";\r\n    container.appendChild(view.el);\r\n\r\n    if(view.onShow) view.onShow();\r\n  }\r\n}\r\n\r\n(function(){\r\n\r\n  class View {\r\n    render() {\r\n      console.log('rendering', this.el);\r\n      var templateStr = this.template(this.model.properties);\r\n\r\n      // create the dom node\r\n      var node = document.createElement(this.tagName || 'div');\r\n      node.innerHTML = templateStr;\r\n      this.el = node;\r\n\r\n      // bind events\r\n      setEvents(this);\r\n\r\n      // setup bindings\r\n      setBindings(this);\r\n\r\n      if(this.onRender) this.onRender();\r\n    }\r\n  }\r\n\r\n  function setEvents(view) {\r\n    for(var key in view.events) {\r\n      var i;\r\n      var tokens = key.split(\" \");\r\n\r\n      var eventStr = tokens[0];\r\n      var selector = '';\r\n\r\n      for(i = 1; i < tokens.length; i++) {\r\n        selector += tokens[i] + \" \";\r\n      }\r\n\r\n      var nodes = view.el.querySelectorAll(selector);\r\n\r\n      for(i = 0; i < nodes.length; i++) {\r\n        var node = nodes[i];\r\n        node.addEventListener(eventStr, view.events[key]);\r\n      }\r\n\r\n    }\r\n  }\r\n\r\n  function setBindings(view) {\r\n    for(var key in view.bindings){\r\n      var i;\r\n      var propName = view.bindings[key];\r\n      var nodes = view.el.querySelectorAll(key);\r\n\r\n      for(i = 0; i < nodes.length; i++) {\r\n        var node = nodes[i];\r\n        bindNodeToProperty(node, view.model, propName);\r\n      }\r\n\r\n    }\r\n  }\r\n\r\n  function bindNodeToProperty(node, model, propName){\r\n    // todo: refactor this... make it configurable?\r\n\r\n    if(node.tagName == 'INPUT'){\r\n      node.value = model.get(propName);\r\n\r\n      node.addEventListener('propertychange', function(){\r\n        model.set(propName, this.value);\r\n      });\r\n\r\n      node.addEventListener('input', function(){\r\n        model.set(propName, this.value);\r\n      });\r\n\r\n      node.addEventListener('change', function(){\r\n        model.set(propName, this.value);\r\n      });\r\n    }\r\n    else{\r\n      node.textContent = model.get(propName);\r\n\r\n      model.on('change:' + propName, function(val) {\r\n        node.textContent = val;\r\n      });\r\n    }\r\n  }\r\n\r\n  window.View = View;\r\n\r\n})();\r\n\r\n\r\nclass Model {\r\n  get(propName) {\r\n    return this.properties[propName];\r\n  }\r\n\r\n  set(propName, value) {\r\n    this.properties[propName] = value;\r\n    \r\n    for(var i in this._events){\r\n      var e = this._events[i];\r\n      // trigger \"change\" events\r\n      if(e.eventDescription == \"change\") e.callback(value);\r\n\r\n      // trigger \"change:propName\" events\r\n      if(e.eventDescription == \"change:\" + propName) e.callback(value);\r\n    }\r\n  }\r\n\r\n  on(eventDescription, callback) {\r\n    this._events = this._events || [];\r\n    this._events.push({eventDescription, callback});\r\n  }\r\n}\r\n\r\n\r\nclass MyModel extends Model {\r\n  constructor(properties) {\r\n    this.properties = properties;\r\n  }\r\n}\r\n\r\n\r\nclass MyView extends View {\r\n  constructor(params) {\r\n    this.model = params.model;\r\n    this.template = Handlebars.compile(document.getElementById('my-template').innerHTML);\r\n    this.tagName = 'p';\r\n\r\n    this.events = {\r\n      'click button': this.onClickButton,\r\n    };\r\n\r\n    this.bindings = {\r\n      \"[name=firstName]\": 'firstName',\r\n      \"[name=lastName]\": 'lastName',\r\n      \".firstName-label\": 'firstName',\r\n      '.lastName-label': 'lastName',\r\n    };\r\n  }\r\n\r\n  onRender() {\r\n    console.log('done rendering', this.el);\r\n  }\r\n\r\n  onShow() {\r\n    console.log('el placed in dom', this.el);\r\n  }\r\n\r\n  onClickButton() {\r\n    alert('clicked.');\r\n  }\r\n}\r\n\r\n\r\nclass MyRegion extends Region {\r\n  constructor() {\r\n    this.container = \"#main\";\r\n  }\r\n}\r\n\r\n\r\nvar myRegion = new MyRegion();\r\n\r\nvar myModel = new MyModel({\r\n  firstName: \"Gob\",\r\n  lastName: \"Bluth\",\r\n});\r\n\r\nvar myView = new MyView({\r\n  model: myModel\r\n});\r\n\r\nmyRegion.show(myView);\r\n"]}